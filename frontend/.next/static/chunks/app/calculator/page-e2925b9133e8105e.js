(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{647:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])},1412:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(5155),n=a(2619),l=a.n(n),i=a(7937);function c(e){let{items:t}=e;return(0,s.jsx)("nav",{className:"flex items-center space-x-2 text-sm mb-6",children:t.map((e,a)=>{let n=a===t.length-1;return(0,s.jsxs)("div",{className:"flex items-center",children:[a>0&&(0,s.jsx)(i.A,{className:"w-4 h-4 mx-2 text-gray-500"}),e.href&&!n?(0,s.jsxs)(l(),{href:e.href,className:"flex items-center gap-2 text-purple-400 hover:text-purple-300 transition-colors",children:[e.icon,e.label]}):(0,s.jsxs)("span",{className:"flex items-center gap-2 ".concat(n?"text-gray-300 font-semibold":"text-gray-500"),children:[e.icon,e.label]})]},a)})})}},1524:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},1712:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},3155:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(5155),n=a(2115),l=a(7621),i=a(1712),c=a(647),r=a(6154),o=a(6983),d=a(1524),m=a(3327),h=a(8734),p=a(1412);function g(){let[e,t]=(0,n.useState)(""),[a,g]=(0,n.useState)(10),[x,u]=(0,n.useState)(1),[y,b]=(0,n.useState)([]),[f,j]=(0,n.useState)(null),[N,w]=(0,n.useState)(!1),[v,k]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await l.t_.browseDatasets();b(e.datasets||[]),e.datasets&&e.datasets.length>0&&t(e.datasets[0].path)}catch(e){console.error("Failed to load datasets:",e)}})()},[]);let S=async()=>{if(!e)return void k("Please select a dataset");if(x<=0)return void k("Batch size must be greater than 0");try{w(!0),k(null);let t=await l.t_.calculateSteps({dataset_path:e,epochs:a,batch_size:x});j(t)}catch(e){k(e.message||"Calculation failed"),j(null)}finally{w(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 max-w-7xl",children:[(0,s.jsx)(p.A,{items:[{label:"Home",href:"/",icon:(0,s.jsx)(i.A,{className:"w-4 h-4"})},{label:"Step Calculator",icon:(0,s.jsx)(c.A,{className:"w-4 h-4"})}]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-5xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-indigo-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent",children:"LoRA Step Calculator"}),(0,s.jsx)("p",{className:"text-xl text-gray-300",children:"Calculate optimal training steps with Kohya-compatible logic"})]}),(0,s.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Training Parameters"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Dataset Path"}),y.length>0?(0,s.jsx)("select",{value:e,onChange:e=>t(e.target.value),className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-600 text-white rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 mb-2",children:y.map(e=>(0,s.jsxs)("option",{value:e.path,children:[e.name," (",e.image_count," images, ",e.repeats,"x repeats)"]},e.path))}):(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"w-full px-3 py-2 bg-slate-900/50 border border-slate-600 text-white rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",placeholder:"datasets/10_character_name"}),(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 text-sm",children:[(0,s.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100 mb-1",children:"\uD83D\uDCC1 Kohya Format"}),(0,s.jsx)("p",{className:"text-blue-700 dark:text-blue-300",children:'Auto-detects repeat counts from folder names (e.g., "10_character_name" → 10 repeats)'})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Epochs"}),(0,s.jsx)("input",{type:"number",value:a,onChange:e=>g(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Batch Size"}),(0,s.jsx)("input",{type:"number",value:x,onChange:e=>u(parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]}),(0,s.jsxs)("button",{onClick:S,disabled:N,className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[(0,s.jsx)(c.A,{className:"w-5 h-5"}),N?"Calculating...":"Calculate Steps"]}),v&&(0,s.jsx)("div",{className:"mt-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:v}),(0,s.jsxs)("div",{className:"mt-6 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium mb-2",children:"\uD83D\uDCCA Formula"}),(0,s.jsx)("code",{className:"text-xs bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"(Images \xd7 Repeats \xd7 Epochs) \xf7 Batch Size = Steps"})]})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Results"}),f?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg p-6 text-white text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,s.jsx)(r.A,{className:"w-6 h-6"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Total Steps"})]}),(0,s.jsx)("div",{className:"text-5xl font-bold",children:f.total_steps.toLocaleString()})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1",children:"Images"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.images})]}),(0,s.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400 mb-1",children:"Repeats"}),(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[f.repeats,"x"]})]}),(0,s.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400 mb-1",children:"Epochs"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.epochs})]}),(0,s.jsxs)("div",{className:"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm text-pink-600 dark:text-pink-400 mb-1",children:"Batch Size"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.batch_size})]})]}),f.caption&&(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Detected Caption"}),(0,s.jsx)("div",{className:"font-mono text-sm",children:f.caption})]}),(0,s.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(o.A,{className:"w-5 h-5 text-gray-600"}),(0,s.jsx)("span",{className:"font-semibold",children:"Time Estimates (approximate)"})]}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"GPU Rental (faster):"}),(0,s.jsxs)("span",{className:"font-medium",children:[f.time_estimate_min.toFixed(1)," min"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Home GPU (slower):"}),(0,s.jsxs)("span",{className:"font-medium",children:[f.time_estimate_max.toFixed(1)," min"]})]})]})]}),(0,s.jsx)("div",{className:"rounded-lg p-4 ".concat(f.recommendation.includes("✅")?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800"),children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(d.A,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold mb-1",children:"Training Analysis"}),(0,s.jsx)("div",{className:"text-sm",children:f.recommendation})]})]})}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-50 dark:bg-gray-800 rounded p-2",children:f.dataset_path})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(c.A,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Enter your parameters and click Calculate"})]})]})]}),(0,s.jsxs)("div",{className:"mt-8 grid md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-3 rounded-lg",children:(0,s.jsx)(m.A,{className:"w-6 h-6 text-blue-600"})}),(0,s.jsx)("h3",{className:"font-semibold",children:"Kohya Compatible"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Uses the same calculation logic as Kohya sd-scripts for accurate step counts"})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-3 rounded-lg",children:(0,s.jsx)(h.A,{className:"w-6 h-6 text-purple-600"})}),(0,s.jsx)("h3",{className:"font-semibold",children:"Auto-Detection"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Automatically detects repeat counts and image counts from your dataset folder"})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-3 rounded-lg",children:(0,s.jsx)(r.A,{className:"w-6 h-6 text-green-600"})}),(0,s.jsx)("h3",{className:"font-semibold",children:"No More Guessing"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Get instant recommendations on whether your step count is optimal for training"})]})]})]})})}},3327:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},3397:(e,t,a)=>{Promise.resolve().then(a.bind(a,3155))},6154:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},6983:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7621:(e,t,a)=>{"use strict";a.d(t,{BO:()=>d,Dp:()=>c,Zq:()=>i,jp:()=>l,t_:()=>o,vt:()=>r});let s=a(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api";async function n(e){if(!e.ok)throw Error((await e.json().catch(()=>({detail:"Unknown error"}))).detail||"HTTP ".concat(e.status));return e.json()}let l={list:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/workspace";return n(await fetch("".concat(s,"/files/list?path=").concat(encodeURIComponent(e))))},upload:async(e,t)=>{let a=new FormData;return a.append("file",e),n(await fetch("".concat(s,"/files/upload?destination=").concat(encodeURIComponent(t)),{method:"POST",body:a}))},delete:async e=>n(await fetch("".concat(s,"/files/delete?path=").concat(encodeURIComponent(e)),{method:"DELETE"})),rename:async(e,t)=>n(await fetch("".concat(s,"/files/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_path:e,new_name:t})})),mkdir:async(e,t)=>n(await fetch("".concat(s,"/files/mkdir"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,name:t})})),read:async e=>n(await fetch("".concat(s,"/files/read/").concat(encodeURIComponent(e.substring(1))))),write:async(e,t)=>n(await fetch("".concat(s,"/files/write"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,content:t})}))},i={list:async()=>n(await fetch("".concat(s,"/dataset/list"))),uploadBatch:async(e,t)=>{let a=new FormData;return e.forEach(e=>a.append("files",e)),n(await fetch("".concat(s,"/dataset/upload-batch?dataset_name=").concat(encodeURIComponent(t)),{method:"POST",body:a}))},tag:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wd14-vit-v2",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.35;return n(await fetch("".concat(s,"/dataset/tag"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,model:t,threshold:a})}))},create:async e=>n(await fetch("".concat(s,"/dataset/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})})),getImagesWithTags:async e=>n(await fetch("".concat(s,"/dataset/images-with-tags?dataset_path=").concat(encodeURIComponent(e)))),updateTags:async(e,t)=>n(await fetch("".concat(s,"/dataset/update-tags"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_path:e,tags:t})})),bulkTagOperation:async(e,t,a,l)=>n(await fetch("".concat(s,"/dataset/bulk-tag-operation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,operation:t,tags:a,replace_with:l||""})})),injectTriggerWord:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start";return n(await fetch("".concat(s,"/dataset/inject-trigger-word"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,trigger_word:t,position:a})}))}},c={start:async e=>n(await fetch("".concat(s,"/training/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),stop:async()=>n(await fetch("".concat(s,"/training/stop"),{method:"POST"})),status:async()=>n(await fetch("".concat(s,"/training/status"))),validate:async e=>n(await fetch("".concat(s,"/training/validate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),connectLogs:(e,t)=>{let a=new WebSocket("ws://localhost:8000/api/training/logs");return a.onmessage=t=>{e(JSON.parse(t.data))},t&&(a.onerror=t),a}},r={templates:async()=>n(await fetch("".concat(s,"/config/templates"))),load:async e=>n(await fetch("".concat(s,"/config/load?path=").concat(encodeURIComponent(e)))),save:async(e,t)=>n(await fetch("".concat(s,"/config/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,config:t})})),defaults:async()=>n(await fetch("".concat(s,"/config/defaults")))},o={calculateSteps:async e=>n(await fetch("".concat(s,"/utilities/calculator"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),browseDatasets:async()=>n(await fetch("".concat(s,"/utilities/datasets/browse"))),listLoraFiles:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"safetensors",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name";return n(await fetch("".concat(s,"/utilities/lora/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({directory:e,file_extension:t,sort_by:a})}))},getResizeDimensions:async()=>n(await fetch("".concat(s,"/utilities/lora/resize-dimensions"))),resizeLora:async(e,t,a,l)=>n(await fetch("".concat(s,"/utilities/lora/resize"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input_path:e,output_path:t,new_dim:a,new_alpha:l})})),uploadToHuggingFace:async e=>n(await fetch("".concat(s,"/utilities/hf/upload"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),validateHfToken:async e=>n(await fetch("".concat(s,"/utilities/hf/validate-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hf_token:e})}))},d={download:async(e,t,a)=>n(await fetch("".concat(s,"/models/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,download_type:t,model_type:a})})),list:async()=>n(await fetch("".concat(s,"/models/list"))),delete:async(e,t)=>n(await fetch("".concat(s,"/models/").concat(e,"/").concat(encodeURIComponent(t)),{method:"DELETE"})),popular:async()=>n(await fetch("".concat(s,"/models/popular")))}},7937:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8734:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(1847).A)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])}},e=>{e.O(0,[297,441,255,358],()=>e(e.s=3397)),_N_E=e.O()}]);