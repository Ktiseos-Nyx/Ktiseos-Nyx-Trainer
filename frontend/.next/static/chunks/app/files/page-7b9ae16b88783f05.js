(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[638],{2001:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(1847).A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]])},5626:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6111:(e,t,a)=>{Promise.resolve().then(a.bind(a,7529)),Promise.resolve().then(a.t.bind(a,2619,23))},6191:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(1847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7529:(e,t,a)=>{"use strict";a.d(t,{default:()=>g});var n=a(5155),s=a(2115),o=a(1636),c=a(9847),i=a(2196);let r=(0,a(1847).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var l=a(2001),d=a(6191),h=a(5626),p=a(1786),y=a(9867),m=a(1360),f=a(7621);function g(){let[e,t]=(0,s.useState)("~"),[a,g]=(0,s.useState)(null),[u,x]=(0,s.useState)(!1),[b,w]=(0,s.useState)(null),[j,N]=(0,s.useState)(null),v=(0,s.useCallback)(async e=>{x(!0),w(null);try{let a=await f.jp.list(e);g(a),t(a.path)}catch(a){let t=a instanceof Error?a.message:"Failed to load directory";t.includes("fetch")||t.includes("Failed to fetch")?w("Backend API not running. Start the backend server to browse files."):w(t),g({path:e,files:[],directories:[]})}finally{x(!1)}},[]);(0,s.useEffect)(()=>{v(e)},[]);let k=(0,s.useCallback)(async t=>{for(let a of t)try{await f.jp.upload(a,e)}catch(e){console.error("Failed to upload ".concat(a.name,":"),e)}v(e)},[e,v]),{getRootProps:T,getInputProps:S,isDragActive:O}=(0,o.VB)({onDrop:k,noClick:!0}),C=e=>{v(e)},_=async t=>{if(confirm("Delete ".concat(t.name,"?")))try{await f.jp.delete(t.path),v(e)}catch(e){alert("Failed to delete: ".concat(e))}},P=async()=>{let t=prompt("Directory name:");if(t)try{await f.jp.mkdir(e,t),v(e)}catch(e){alert("Failed to create directory: ".concat(e))}};return(0,n.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-900",children:[(0,n.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700 p-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"File Manager"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsxs)("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[(0,n.jsx)(d.A,{className:"w-4 h-4"}),"New Folder"]})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(null==a?void 0:a.parent)&&(0,n.jsx)("button",{onClick:()=>C(a.parent),className:"text-blue-500 hover:text-blue-700",children:(0,n.jsx)(h.A,{className:"w-4 h-4"})}),(0,n.jsx)("span",{className:"text-gray-600 dark:text-gray-400 font-mono",children:e})]})]}),(0,n.jsxs)("div",{...T(),className:"flex-1 relative",children:[(0,n.jsx)("input",{...S()}),O&&(0,n.jsx)("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-20 border-4 border-dashed border-blue-500 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(p.A,{className:"w-16 h-16 text-blue-500 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-xl font-semibold text-blue-700",children:"Drop files here to upload"})]})}),(0,n.jsxs)("div",{className:"p-4 overflow-auto h-full",children:[u&&(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("p",{className:"text-gray-500",children:"Loading..."})}),b&&(0,n.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:b}),a&&!u&&(0,n.jsxs)("div",{className:"space-y-1",children:[0===a.files.length&&(0,n.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,n.jsx)(c.A,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,n.jsx)("p",{children:"Empty directory"}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Drag & drop files here to upload"})]}),a.files.map(e=>(0,n.jsxs)("div",{className:"\n                    flex items-center justify-between p-3 rounded hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer\n                    ".concat((null==j?void 0:j.path)===e.path?"bg-blue-50 dark:bg-blue-900":"","\n                  "),onClick:()=>{"dir"===e.type?C(e.path):N(e)},children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:["dir"===e.type?(0,n.jsx)(c.A,{className:"w-5 h-5 text-blue-500"}):e.is_image?(0,n.jsx)(i.A,{className:"w-5 h-5 text-green-500"}):e.name.endsWith(".toml")||e.name.endsWith(".json")?(0,n.jsx)(r,{className:"w-5 h-5 text-orange-500"}):(0,n.jsx)(l.A,{className:"w-5 h-5 text-gray-500"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:e.name}),(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[(e=>{if(0===e)return"-";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,t)).toFixed(2)," ").concat(["B","KB","MB","GB"][t])})(e.size)," â€¢"," ",new Date(1e3*e.modified).toLocaleString()]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["file"===e.type&&(0,n.jsx)("button",{onClick:t=>{t.stopPropagation(),window.open("/api/files/download".concat(e.path),"_blank")},className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",title:"Download",children:(0,n.jsx)(y.A,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e)},className:"p-2 hover:bg-red-100 dark:hover:bg-red-900 rounded text-red-500",title:"Delete",children:(0,n.jsx)(m.A,{className:"w-4 h-4"})})]})]},e.path))]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-800",children:(0,n.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,n.jsx)(p.A,{className:"w-4 h-4"}),"Drag & drop files anywhere to upload to current directory"]})})]})}},7621:(e,t,a)=>{"use strict";a.d(t,{BO:()=>d,Dp:()=>i,Zq:()=>c,jp:()=>o,t_:()=>l,vt:()=>r});let n=a(5704).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api";async function s(e){if(!e.ok)throw Error((await e.json().catch(()=>({detail:"Unknown error"}))).detail||"HTTP ".concat(e.status));return e.json()}let o={list:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/workspace";return s(await fetch("".concat(n,"/files/list?path=").concat(encodeURIComponent(e))))},upload:async(e,t)=>{let a=new FormData;return a.append("file",e),s(await fetch("".concat(n,"/files/upload?destination=").concat(encodeURIComponent(t)),{method:"POST",body:a}))},delete:async e=>s(await fetch("".concat(n,"/files/delete?path=").concat(encodeURIComponent(e)),{method:"DELETE"})),rename:async(e,t)=>s(await fetch("".concat(n,"/files/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_path:e,new_name:t})})),mkdir:async(e,t)=>s(await fetch("".concat(n,"/files/mkdir"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,name:t})})),read:async e=>s(await fetch("".concat(n,"/files/read/").concat(encodeURIComponent(e.substring(1))))),write:async(e,t)=>s(await fetch("".concat(n,"/files/write"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,content:t})}))},c={list:async()=>s(await fetch("".concat(n,"/dataset/list"))),uploadBatch:async(e,t)=>{let a=new FormData;return e.forEach(e=>a.append("files",e)),s(await fetch("".concat(n,"/dataset/upload-batch?dataset_name=").concat(encodeURIComponent(t)),{method:"POST",body:a}))},tag:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wd14-vit-v2",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.35;return s(await fetch("".concat(n,"/dataset/tag"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,model:t,threshold:a})}))},create:async e=>s(await fetch("".concat(n,"/dataset/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})})),getImagesWithTags:async e=>s(await fetch("".concat(n,"/dataset/images-with-tags?dataset_path=").concat(encodeURIComponent(e)))),updateTags:async(e,t)=>s(await fetch("".concat(n,"/dataset/update-tags"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image_path:e,tags:t})})),bulkTagOperation:async(e,t,a,o)=>s(await fetch("".concat(n,"/dataset/bulk-tag-operation"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,operation:t,tags:a,replace_with:o||""})})),injectTriggerWord:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start";return s(await fetch("".concat(n,"/dataset/inject-trigger-word"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataset_path:e,trigger_word:t,position:a})}))}},i={start:async e=>s(await fetch("".concat(n,"/training/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),stop:async()=>s(await fetch("".concat(n,"/training/stop"),{method:"POST"})),status:async()=>s(await fetch("".concat(n,"/training/status"))),validate:async e=>s(await fetch("".concat(n,"/training/validate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),connectLogs:(e,t)=>{let a=new WebSocket("ws://localhost:8000/api/training/logs");return a.onmessage=t=>{e(JSON.parse(t.data))},t&&(a.onerror=t),a}},r={templates:async()=>s(await fetch("".concat(n,"/config/templates"))),load:async e=>s(await fetch("".concat(n,"/config/load?path=").concat(encodeURIComponent(e)))),save:async(e,t)=>s(await fetch("".concat(n,"/config/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,config:t})})),defaults:async()=>s(await fetch("".concat(n,"/config/defaults")))},l={calculateSteps:async e=>s(await fetch("".concat(n,"/utilities/calculator"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),browseDatasets:async()=>s(await fetch("".concat(n,"/utilities/datasets/browse"))),listLoraFiles:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"safetensors",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name";return s(await fetch("".concat(n,"/utilities/lora/list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({directory:e,file_extension:t,sort_by:a})}))},getResizeDimensions:async()=>s(await fetch("".concat(n,"/utilities/lora/resize-dimensions"))),resizeLora:async(e,t,a,o)=>s(await fetch("".concat(n,"/utilities/lora/resize"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input_path:e,output_path:t,new_dim:a,new_alpha:o})})),uploadToHuggingFace:async e=>s(await fetch("".concat(n,"/utilities/hf/upload"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),validateHfToken:async e=>s(await fetch("".concat(n,"/utilities/hf/validate-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hf_token:e})}))},d={download:async(e,t,a)=>s(await fetch("".concat(n,"/models/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,download_type:t,model_type:a})})),list:async()=>s(await fetch("".concat(n,"/models/list"))),delete:async(e,t)=>s(await fetch("".concat(n,"/models/").concat(e,"/").concat(encodeURIComponent(t)),{method:"DELETE"})),popular:async()=>s(await fetch("".concat(n,"/models/popular")))}},9847:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(1847).A)("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]])}},e=>{e.O(0,[297,591,441,255,358],()=>e(e.s=6111)),_N_E=e.O()}]);