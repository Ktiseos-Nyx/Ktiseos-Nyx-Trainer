# Ktiseos-Nyx-Trainer - FINAL Cleaned & Consolidated Requirements (CUDA 12.1 Ready)
# Optimized for VastAI 4090 with vastai/pytorch:2.4.1-cuda-12.1.1-py312-22.04 base image.
# NOTE: torch and torchvision have been REMOVED as they are provided by the base image.

# Core FastAPI and Web Server
fastapi>=0.110.0
uvicorn[standard]>=0.27.0
python-multipart>=0.0.9
aiofiles>=23.2.1
websockets>=12.0
pydantic>=2.6.0
pydantic-settings>=2.2.0
aiohttp>=3.9.0
starlette

# Core Training & ML Dependencies
# torch/torchvision removed - provided by base image (2.4.1/12.1)
numpy>=1.24.0
accelerate==0.33.0
transformers==4.54.1
safetensors==0.5.3
diffusers[torch]==0.32.1
bitsandbytes==0.45.5 # CRITICAL: Verify this version's wheel is CUDA 12.1 compatible
torch-fidelity==0.3.0
einops==0.8.1
pytorch-lightning==1.9.0

# Optimizers & Schedulers
prodigyopt==1.1.2
lion-pytorch==0.2.3
dadaptation==3.2
pytorch_optimizer==3.1.2
schedulefree==1.4
prodigy-plus-schedule-free
came-pytorch

# General Utilities
colorama>=0.4.6
toml>=0.10.2
tqdm>=4.66.4
rich>=13.0,<15.0
ftfy>=6.2.0
requests>=2.28.0
psutil
tomlkit
pyyaml
pandas
scipy
omegaconf
huggingface-hub>=0.34.3
voluptuous>=0.15.2
sentencepiece>=0.2.1
wheel
coverage==7.8.0
parameterized==0.9.0
hpsv2==1.2.0
narwhals==1.34.1
matplotlib==3.10.1


# Image/Data Handling
Pillow>=10.3.0
opencv-python==4.10.0.84
imageio>=2.34.1
imageio-ffmpeg>=0.5.1
pyarrow>=16.1.0
Jinja2>=3.1.4
imagesize>=1.4.1
setuptools>=78.1.1

# Monitoring & Logging
wandb>=0.17.0
watchdog>=4.0.0
tensorboard

# ONNX / Tagger Dependencies
# Use Microsoft's CUDA 12 package index for proper GPU support
# NOTE: --extra-index-url must be on separate line before the package
--extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-12/pypi/simple/
onnx>=1.16.1
onnxruntime-gpu==1.17.1
protobuf>=3.20.0,<4  # Pin to latest 3.x for ONNX 1.16 compatibility (CVE-2025-4565: low risk, trusted sources only)

# -- Essential Commented Dependencies (Now Active) --
timm==0.6.12 # Required for BLIP captioning
fairscale==0.4.13 # Required for BLIP captioning
